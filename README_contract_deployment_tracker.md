# 以太坊合约部署追踪工具

这个工具可以查找指定地址在最近N天内在以太坊主网上部署的所有合约地址。

## 功能特性

- 🔍 **智能查找**: 自动检测合约部署交易（to字段为空的成功交易）
- 📊 **详细信息**: 获取合约地址、部署时间、Gas费用、区块号等详细信息
- 🏷️ **合约元数据**: 从Etherscan获取合约名称、编译器版本、是否代理合约等信息
- 💾 **结果保存**: 自动保存JSON和TXT格式的详细报告
- 🎭 **演示模式**: 提供模拟数据演示功能

## 文件说明

### 1. `contract_deployment_tracker.py` - 正式版本
需要配置Etherscan API密钥和RPC节点，可以获取真实的区块链数据。

#### 环境变量配置 (.env文件)
```bash
# Etherscan API密钥（必需）
ETHERSCAN_API_KEY=你的API密钥

# RPC节点URL（可选，默认使用免费公共节点）
WEB3_RPC_URL=https://eth.llamarpc.com

# 或者使用付费服务
# WEB3_RPC_URL=https://eth-mainnet.g.alchemy.com/v2/YOUR_PROJECT_ID
# WEB3_RPC_URL=https://mainnet.infura.io/v3/YOUR_PROJECT_ID
```

#### 使用方法
```bash
# 查找最近7天的合约部署
python contract_deployment_tracker.py 0x地址

# 查找最近3天的合约部署
python contract_deployment_tracker.py 0x地址 3
```

### 2. `contract_deployment_demo.py` - 演示版本
使用模拟数据演示功能，无需API密钥即可运行。

#### 使用方法
```bash
# 运行演示
python contract_deployment_demo.py 0x地址
```

## 输出结果

工具会生成两种格式的报告：

### 1. 控制台输出
实时显示查询进度和结果摘要，包括：
- 部署者地址
- 查询时间范围
- 找到的合约数量
- 每个合约的详细信息

### 2. 文件输出
自动保存到 `temp/` 目录：
- **JSON文件**: 完整的结构化数据，适合程序处理
- **TXT文件**: 可读性强的文本报告，适合人工查看

## 输出信息详解

对于每个找到的合约，工具会显示：

| 字段 | 说明 |
|------|------|
| 🔗 交易哈希 | 部署交易的哈希值 |
| 🏠 合约地址 | 部署后的合约地址 |
| 📦 区块号 | 部署交易所在的区块 |
| 🕐 部署时间 | 具体的部署时间 |
| ⛽ Gas使用 | 实际消耗的Gas数量 |
| 💰 Gas价格 | Gas价格（以Gwei为单位） |
| 💸 部署成本 | 总部署费用（以ETH为单位） |
| 📏 合约代码大小 | 合约字节码大小 |
| 📝 合约名称 | 合约的名称（如果已验证） |
| 🔧 编译器版本 | Solidity编译器版本 |
| ⚡ 优化 | 是否启用了编译器优化 |
| 🔄 代理合约 | 是否为代理合约 |
| 🎯 实现合约 | 代理合约的实现地址（如适用） |

## 知名地址示例

以下是一些可以用于测试的知名部署者地址：

| 地址 | 描述 |
|------|------|
| `0xd8dA6BF26964aF9D7eEd9e03E53415D37aA96045` | Vitalik Buterin |
| `0x1f9840a85d5aF5bf1D1762F925BDADdC4201F984` | Uniswap相关 |
| `0x4f2083f5fBede34C2714aF59e9076b4Ebf31e5F0` | OpenZeppelin |
| `0x3fC91A3afd70395Cd496C647d5a6CC9D4B2b7FAD` | Uniswap Labs |

## 技术原理

### 合约部署识别
合约部署交易有以下特征：
1. `to` 字段为空（null或空字符串）
2. 交易状态为成功（txreceipt_status = 1）
3. 交易收据中包含 `contractAddress` 字段

### 数据获取流程
1. **获取交易列表**: 使用Etherscan API获取指定地址的所有交易
2. **时间筛选**: 根据指定天数筛选最近的交易
3. **部署识别**: 识别合约部署交易
4. **地址提取**: 从交易收据获取合约地址
5. **元数据获取**: 从Etherscan获取合约源码和编译信息
6. **结果整理**: 格式化并保存结果

## 注意事项

### API限制
- Etherscan免费API有速率限制（5请求/秒）
- 建议使用付费API密钥以获得更好的性能
- 工具已内置延迟机制避免触发限制

### 数据准确性
- 结果依赖于Etherscan API的数据质量
- 某些合约可能未在Etherscan上验证，导致元数据缺失
- 代理合约的识别依赖于Etherscan的分析结果

### 性能考虑
- 查询活跃地址可能需要较长时间
- 建议从较短的时间范围开始查询
- 大量合约的元数据获取会增加查询时间

## 故障排除

### 常见错误

1. **API错误 NOTOK**
   - 检查ETHERSCAN_API_KEY是否正确设置
   - 确认API密钥有效且未超出配额

2. **Web3连接失败**
   - 检查WEB3_RPC_URL设置
   - 尝试使用不同的RPC提供商

3. **无结果**
   - 确认地址在指定时间范围内有交易活动
   - 尝试扩大查询时间范围

### 调试建议
1. 先使用演示版本确认工具正常工作
2. 检查.env文件配置
3. 使用知名地址进行测试
4. 查看控制台输出的详细错误信息

## 扩展功能

工具框架支持以下扩展：
- 支持其他区块链网络（BSC、Polygon等）
- 添加合约交互分析
- 集成更多数据源
- 实时监控功能
- 批量地址查询

## 许可证

本工具遵循开源许可证，可自由使用和修改。

---

**作者**: GitHub Copilot  
**更新时间**: 2025年10月24日