# Chain Monitor - 区块链监控工具

一个用于监控以太坊区块链上大额 USDT 转账的工具集。

## 功能特性

- 🔍 **USDT 大额转账监控**: 使用 Etherscan API 实时监控大额 USDT 转账
- 📈 **余额激增监控**: 监控最近24小时余额新增超过5M且48小时前余额<100k的地址
- 🌐 **地址交互分析**: 分析指定地址的所有 USDT 交互记录，识别资金流向
- 🎯 **Concrete_STABLE专项分析**: 专门分析 Concrete_STABLE 地址的交互模式
-  **详细分析报告**: 提供转账统计、地址分析和趋势报告
- 🚨 **自动通知**: 支持通过 IFTTT 发送大额转账警报
- 💾 **数据存储**: 可选择将监控数据保存到数据库
- ⚡ **快速查询**: 提供独立的快速查询工具

## 文件说明

- `monitor_launcher.py` - 🚀 **统一启动器**，交互式菜单访问所有功能
- `mainnet_monitor.py` - 完整的 USDT 监控系统，支持定时任务和数据库存储
- `usdt_quick_check.py` - 多功能监控工具，支持大额转账查询和余额激增监控
- `balance_surge_monitor.py` - 专门的余额激增监控工具 + 地址交互分析
- `analyze_concrete_stable.py` - 🆕 **Concrete_STABLE专项分析工具**
- `balance_surge_demo.py` - 余额激增监控演示和策略指南
- `demo.py` - 功能演示脚本
- `monitor.py` - 基础监控框架
- `base.py` - 基础工具函数（数据库连接、通知等）

## 快速开始

### 1. 安装依赖

```bash
pip install -r requirements.txt
```

### 2. 获取 Etherscan API 密钥

访问 [https://etherscan.io/apis](https://etherscan.io/apis) 注册并获取免费的 API 密钥。

### 3. 配置环境变量

复制并修改环境变量模板：

```bash
cp .env.template .env
```

编辑 `.env` 文件，填入您的 API 密钥：

```env
ETHERSCAN_API_KEY=你的_etherscan_api_密钥
```

### 4. 使用监控工具

**最简单的方式 - 使用启动器：**

```bash
python monitor_launcher.py
```

这会打开一个交互式菜单，包含所有监控功能。

**直接使用具体工具：**

**大额转账查询：**

```bash
python usdt_quick_check.py
```

然后选择功能 1，或者直接通过命令行：

```bash
python usdt_quick_check.py 1000000 24
```

**余额激增监控：**

```bash
python usdt_quick_check.py
```

然后选择功能 2，或者使用专门的余额监控工具：

```bash
python balance_surge_monitor.py 5000000 100000
```

**地址交互分析：**

```bash
# 分析任意地址的交互
python balance_surge_monitor.py
# 然后选择功能 2

# 专门分析 Concrete_STABLE 地址
python analyze_concrete_stable.py 30
```

**快速分析 Concrete_STABLE：**

```bash
python analyze_concrete_stable.py 7  # 分析最近7天
```

参数说明：
- 大额转账查询：`最小金额阈值(USDT) 查询小时数`
- 余额激增监控：`最小增长金额(USDT) 48小时前最大余额(USDT)`
- 地址交互分析：`天数` (分析最近多少天的数据)

## 详细功能

### 1. USDT 大额转账监控

监控功能可以：
- 自定义金额阈值（默认 100万 USDT）
- 指定监控时间范围
- 统计发送方和接收方地址
- 计算转账总金额和笔数
- 生成详细的分析报告

### 2. 余额激增监控 🆕

这是一个特殊的监控功能，用于发现可能的：
- 大额资金流入
- 新的大户地址
- 异常资金聚集

**监控条件：**
- 最近24小时USDT余额新增 ≥ 5,000,000 USDT（可自定义）
- 48小时前余额 < 100,000 USDT（可自定义）

**用途：**
- 发现新的大户地址
- 监控资金异常流动
- 识别可能的市场操作

### 3. 地址交互分析 🆕

全新的地址交互分析功能，可以：
- 分析指定地址的所有 USDT 转账记录
- 识别主要的资金来源和去向
- 统计交互频率和金额
- 生成详细的交互报告

**特色功能：**
- 🎯 专门的 Concrete_STABLE 地址分析
- 📊 交互模式分析（双向、单向交互）
- 💰 大额交互地址识别
- ⏰ 时间模式分析
- 📝 自动生成地址列表文件

**用途：**
- 追踪特定地址的资金流向
- 分析交易所或大户的交互模式
- 识别可能的关联地址
- 研究资金聚集和分散模式

### 使用示例

**查询最近1小时超过500万USDT的转账：**

```bash
python usdt_quick_check.py 5000000 1
```

**监控余额激增地址（24小时新增≥1000万，48小时前<50万）：**

```bash
python balance_surge_monitor.py 10000000 500000
```

**分析 Concrete_STABLE 地址的交互：**

```bash
python analyze_concrete_stable.py 30  # 分析最近30天
```

```
### 输出示例

**大额转账监控输出：**

```
🔍 USDT 大额转账分析报告
================================================================================
📊 分析时间段: 最近 1 小时
🧱 区块范围: 18500000 - 18500240
📈 总转账数: 1,234
💰 大额转账数: 5
💵 大额转账总金额: 25,500,000.00 USDT
📤 唯一发送地址: 4
📥 唯一接收地址: 5
🎯 最小金额阈值: 5,000,000 USDT

💎 前10笔最大转账:
================================================================================

1. 10,000,000.00 USDT
   📤 发送方: 0x1234...5678
   📥 接收方: 0xabcd...efgh
   🕐 时间: 2024-10-24 14:30:25
   🔗 交易哈希: 0x9876...4321
   ⛽ Gas 费用: 0.002500 ETH
```

**余额激增监控输出：**

```
🎉 发现 3 个符合条件的地址!
================================================================================
📊 总计余额增长: 18,500,000.00 USDT
📊 平均增长倍数: 25,600.3%

🏆 #1 地址: 0x1234567890abcdef1234567890abcdef12345678
   📊 48小时前余额: 50,000.00 USDT
   📊 当前余额: 8,050,000.00 USDT
   📈 余额增长: 8,000,000.00 USDT
   📥 24小时接收: 8,100,000.00 USDT
   📊 增长倍数: 16,000.0%
   🔗 查看详情: https://etherscan.io/address/0x1234567890abcdef1234567890abcdef12345678
```
```

## 高级配置

### 数据库集成

如需将监控数据保存到数据库，请在 `.env` 文件中配置数据库连接：

```env
db_url=postgresql://user:password@localhost:5432/database
```

### 通知设置

支持通过 IFTTT Webhook 发送通知：

```env
IFTTT_KEY=你的_ifttt_webhook_密钥
```

### 自定义监控参数

在 `mainnet_monitor.py` 中可以调整：
- 监控金额阈值
- 监控频率
- 区块范围估算
- 通知条件

## API 限制

Etherscan 免费 API 有以下限制：
- 每秒最多 5 次请求
- 每天最多 100,000 次请求

建议在生产环境中：
- 使用付费 API 密钥
- 添加请求频率控制
- 实现错误重试机制

## 注意事项

1. **API 密钥安全**: 请勿将 API 密钥提交到公共代码仓库
2. **网络稳定性**: 确保网络连接稳定，避免请求超时
3. **数据准确性**: 监控结果基于 Etherscan 数据，可能存在轻微延迟
4. **法律合规**: 使用本工具请遵守相关法律法规

## 贡献

欢迎提交 Issue 和 Pull Request 来改进这个项目。

## 许可证

MIT License